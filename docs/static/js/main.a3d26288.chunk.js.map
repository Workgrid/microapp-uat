{"version":3,"sources":["components/Tests.js","components/Debugger.js","pages/Summary.js","pages/IFrameDetail.js","pages/TestDetail.js","App.js","index.js"],"names":["testTypes","name","inDetail","inSummary","microapp","panel","useState","map","testType","loading","result","tests","setTests","testActions","useRef","useEffect","testToken","current","Token","Title","testTitle","Show","testShow","Hide","testHide","updateTest","update","prevTests","test","setTimeout","a","getToken","token","process","decodedToken","decode","aud","console","warn","updateTitle","Math","floor","random","showDetail","url","window","location","origin","pathname","hideDetail","filter","className","key","aria-label","role","onClick","testName","reload","Summary","MicroApp","id","audience","log","initialize","detailPage","title","type","placeholder","Tests","Debugger","Detail","currentCount","setCurrentCount","iframeUrl","setIframeUrl","countdownTimer","setInterval","prev","clearInterval","style","width","borderWidth","src","App","basename","path","exact","component","TestDetail","IFrameDetail","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.a3d26288.chunk.js","sourcesContent":["import React, { useState, useEffect, useRef } from 'react'\nimport { decode } from 'jsonwebtoken'\n\nconst testTypes = [\n  { name: 'Token' },\n  { name: 'Title' },\n  { name: 'Show', inDetail: false },\n  { name: 'Hide', inSummary: false }\n]\n\nexport default ({ microapp, panel = 'summary' }) => {\n  const [tests, setTests] = useState(\n    testTypes.map(testType => ({ inSummary: true, inDetail: true, loading: false, result: false, ...testType }))\n  )\n  const testActions = useRef({})\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  useEffect(() => testToken(), [microapp])\n\n  useEffect(() => {\n    testActions.current.Token = testToken\n    testActions.current.Title = testTitle\n    testActions.current.Show = testShow\n    testActions.current.Hide = testHide\n  })\n\n  const runTest = testName => () => {\n    testActions.current[testName]()\n  }\n\n  const updateTest = (name, update) => {\n    setTests(prevTests => {\n      return prevTests.map(test => {\n        if (test.name === name) {\n          return { ...test, ...update }\n        } else {\n          return test\n        }\n      })\n    })\n  }\n\n  const testToken = () => {\n    if (!microapp) return\n\n    updateTest('Token', { loading: true, result: false })\n    // Arbitrarily add a \"loading time\" other wise you are kind of \"did it work?\"\n    setTimeout(async () => {\n      const token = await microapp.getToken()\n      // This would be done on a server side, notice how I'm not verifying the token\n      const decodedToken = decode(token)\n      // TODO alter this verification when this app is upgraded to the more secure token\n      if (decodedToken.aud === process.env.REACT_APP_AUD) {\n        updateTest('Token', { loading: false, result: true })\n      } else {\n        updateTest('Token', { loading: false, result: false })\n        console.warn(`Invalid token: ${decodedToken.aud} !== ${process.env.REACT_APP_AUD}`)\n      }\n    }, 500)\n  }\n\n  const testTitle = () => {\n    updateTest('Title', { result: false })\n    microapp.updateTitle(`Title Change: ${Math.floor(Math.random() * 500)}`)\n    updateTest('Title', { result: true })\n  }\n\n  const testShow = () => {\n    updateTest('Show', { result: false })\n    microapp.showDetail({ url: `${window.location.origin}${window.location.pathname}#/tests` })\n    updateTest('Show', { result: true })\n  }\n\n  const testHide = () => {\n    updateTest('Hide', { result: false })\n    microapp.hideDetail()\n    updateTest('Hide', { result: true })\n  }\n\n  return (\n    <>\n      <strong>Tests:</strong>\n      {tests\n        .filter(test => (panel === 'summary' && test.inSummary) || (panel === 'detail' && test.inDetail))\n        .map(test => (\n          <div className=\"checklist\" key={test.name}>\n            {test.loading ? (\n              <span aria-label=\"loading\" role=\"img\" className=\"pass\">\n                ü§î\n              </span>\n            ) : (\n              <>\n                {test.result ? (\n                  <span aria-label=\"pass\" role=\"img\" className=\"pass\">\n                    ‚úÖ\n                  </span>\n                ) : (\n                  <span aria-label=\"fail\" role=\"img\" className=\"pass\">\n                    ‚ùå\n                  </span>\n                )}\n              </>\n            )}\n            <div className=\"item\">{test.name}</div>\n            <div className=\"item\">\n              <button className=\"action-small\" onClick={runTest(test.name)}>\n                Run\n              </button>\n            </div>\n          </div>\n        ))}\n    </>\n  )\n}\n","import React from 'react'\n\nexport default () => {\n  return (\n    <>\n      <button className=\"secondary\" onClick={() => window.location.reload(true)}>\n        Refresh\n      </button>\n    </>\n  )\n}\n","import React, { useRef, useEffect } from 'react'\nimport Tests from '../components/Tests'\nimport MicroApp from '@workgrid/micro-app'\nimport Debugger from '../components/Debugger'\nimport './summary.css'\n\nconst Summary = () => {\n  const microapp = useRef(\n    new MicroApp({\n      id: 'edge-microapp-local',\n      audience: 'edge-microapp'\n    })\n  )\n\n  useEffect(() => {\n    console.log('Initialize')\n    microapp.current.initialize()\n    console.log('Post initialize')\n  }, [])\n\n  const showDetail = detailPage => {\n    // We have to use the hash router to show detail due to Github pages limitations\n    console.log('Showing detail')\n    microapp.current.showDetail({\n      url: `${window.location.origin}${window.location.pathname}#/${detailPage}`,\n      title: 'Edge Microapp'\n    })\n  }\n\n  return (\n    <div>\n      <h1>Edge Microapp</h1>\n      <p>This is the \"edgy\" microapp.</p>\n      <section className=\"section\">\n        <input type=\"text\" placeholder=\"Input Test\"></input>\n        <Tests microapp={microapp.current} panel=\"summary\" />\n      </section>\n      <div className=\"action-block vertical\">\n        <Debugger />\n        <button className=\"secondary\" onClick={() => showDetail('iframe')}>\n          Inner iFrame\n        </button>\n        <button className=\"primary\" onClick={() => showDetail('tests')}>\n          Detail Tests\n        </button>\n      </div>\n    </div>\n  )\n}\n\nexport default Summary\n","import React, { useRef, useEffect, useState } from 'react'\nimport MicroApp from '@workgrid/micro-app'\nimport './detail.css'\n\nconst Detail = () => {\n  const microapp = useRef(\n    new MicroApp({\n      id: 'edge-microapp',\n      audience: 'edge-microapp'\n    })\n  )\n\n  const [currentCount, setCurrentCount] = useState(5)\n  const [iframeUrl, setIframeUrl] = useState('')\n  const countdownTimer = useRef()\n\n  useEffect(() => {\n    console.log('Initializing Detail')\n    microapp.current.initialize()\n    countdownTimer.current = setInterval(() => {\n      setCurrentCount(prev => {\n        console.log(!!(prev % 2) ? 'Tick' : 'Tock')\n        return prev - 1\n      })\n    }, 1000)\n  }, [])\n\n  useEffect(() => {\n    if (currentCount <= 0) {\n      setIframeUrl('https://www.catapultsgame.com/app/')\n      clearInterval(countdownTimer.current)\n    }\n  }, [currentCount])\n\n  return (\n    <div className=\"container\">\n      <h1>IFrame Detail</h1>\n      <p>Tests an inner iFrame. This is a typical use case for \"wrapping\" an existing app in a MicroApp.</p>\n      <div className=\"example-block\">\n        <p>Showing iFrame in {currentCount}s</p>\n        <iframe style={{ width: '100%', borderWidth: 1 }} title=\"Example Iframe\" src={iframeUrl} />\n      </div>\n    </div>\n  )\n}\n\nexport default Detail\n","import React, { useRef, useEffect } from 'react'\nimport MicroApp from '@workgrid/micro-app'\nimport './detail.css'\nimport Tests from '../components/Tests'\nimport Debugger from '../components/Debugger'\n\nconst Detail = () => {\n  const microapp = useRef(\n    new MicroApp({\n      id: 'edge-microapp',\n      audience: 'edge-microapp'\n    })\n  )\n\n  useEffect(() => {\n    console.log('Initializing Detail')\n    microapp.current.initialize()\n  }, [])\n\n  return (\n    <div className=\"container\">\n      <h1>Tests Detail</h1>\n      <div className=\"example-block\">\n        <Tests microapp={microapp.current} panel=\"detail\" />\n      </div>\n      <div className=\"action-block\">\n        <Debugger />\n      </div>\n    </div>\n  )\n}\n\nexport default Detail\n","import React from 'react'\nimport { HashRouter as Router, Route } from 'react-router-dom'\n\nimport Summary from './pages/Summary'\nimport IFrameDetail from './pages/IFrameDetail'\n// import FeaturePolicyDetail from './pages/FeaturePolicyDetail'\nimport TestDetail from './pages/TestDetail'\n\nconst App = () => {\n  return (\n    <Router basename={window.location.pathname}>\n      <Route path=\"/\" exact component={Summary} />\n      <Route path=\"/tests\" component={TestDetail} />\n      <Route path=\"/iframe\" component={IFrameDetail} />\n      {/* <Route path=\"/featurepolicy\" component={FeaturePolicyDetail} /> */}\n    </Router>\n  )\n}\n\nexport default App\n","import 'core-js/stable'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}